import type { FlashcardDefinition } from "@/types/flashcard";

export const currentCryptographyFlashcards: readonly FlashcardDefinition[] = [
  {
    id: "cc-fc1",
    topicId: "current-cryptography",
    front: "AES（Advanced Encryption Standard）とは？",
    back: "NISTが2001年に標準化した対称鍵暗号（ブロック暗号）。鍵長128/192/256ビットに対応。ブロックサイズは128ビット固定。TLSのバルク暗号化で最も広く使用される。",
    tags: ["symmetric", "AES", "NIST"],
    relatedLessonId: "cc-lesson-1",
  },
  {
    id: "cc-fc2",
    topicId: "current-cryptography",
    front: "対称鍵暗号の「鍵配送問題」とは？",
    back: "暗号化と復号に同じ鍵を使うため、通信相手に安全に鍵を渡す方法が必要になるという根本的課題。公開鍵暗号やDiffie-Hellman鍵交換で解決される。",
    tags: ["symmetric", "key-distribution"],
    relatedLessonId: "cc-lesson-1",
  },
  {
    id: "cc-fc3",
    topicId: "current-cryptography",
    front: "AES-GCMとは何か？また、なぜ重要か？",
    back: "Galois/Counter Mode。AESの認証付き暗号化（AEAD）モード。暗号化と同時にデータの完全性・真正性を保証する。TLS 1.3で標準的に使用される。",
    tags: ["symmetric", "AES", "AEAD"],
    relatedLessonId: "cc-lesson-1",
  },
  {
    id: "cc-fc4",
    topicId: "current-cryptography",
    front: "RSAの安全性は何に依存しているか？",
    back: "大きな合成数の素因数分解が計算量的に困難であるという仮定。n = p × q のnからp, qを求める問題。古典計算機では準指数時間アルゴリズムしか知られていないが、量子計算機のShorアルゴリズムで多項式時間で解ける。",
    tags: ["RSA", "factoring", "quantum-vulnerable"],
    relatedLessonId: "cc-lesson-2",
  },
  {
    id: "cc-fc5",
    topicId: "current-cryptography",
    front: "RSAの公開鍵と秘密鍵はそれぞれ何で構成されるか？",
    back: "公開鍵: (n, e) — nはモジュラス（p×q）、eは公開指数（通常65537）\n秘密鍵: (n, d) — dはeの逆元（e×d ≡ 1 mod φ(n)）",
    tags: ["RSA", "key-pair"],
    relatedLessonId: "cc-lesson-2",
  },
  {
    id: "cc-fc6",
    topicId: "current-cryptography",
    front: "RSA暗号化で推奨されるパディング方式は？",
    back: "OAEP（Optimal Asymmetric Encryption Padding）。選択暗号文攻撃に対する安全性を提供する。古いPKCS#1 v1.5には脆弱性が知られており、使用すべきでない。",
    tags: ["RSA", "OAEP", "padding"],
    relatedLessonId: "cc-lesson-2",
  },
  {
    id: "cc-fc7",
    topicId: "current-cryptography",
    front: "ECC-256とRSAの鍵長の比較は？",
    back: "ECC-256ビット ≈ RSA-3,072ビット（128ビット安全性）。ECCはRSAの約1/12の鍵長で同等の安全性を実現。計算が高速で、通信データ量も少ない。",
    tags: ["ECC", "RSA", "key-size"],
    relatedLessonId: "cc-lesson-3",
  },
  {
    id: "cc-fc8",
    topicId: "current-cryptography",
    front: "ECDLP（楕円曲線離散対数問題）とは？",
    back: "楕円曲線上の点 G と Q = kG が与えられたとき、スカラー k を求める問題。ECCの安全性の根拠。古典計算機では困難だが、量子計算機のShorアルゴリズムで効率的に解ける。",
    tags: ["ECC", "ECDLP", "quantum-vulnerable"],
    relatedLessonId: "cc-lesson-3",
  },
  {
    id: "cc-fc9",
    topicId: "current-cryptography",
    front: "ECDH（楕円曲線Diffie-Hellman）の役割は？",
    back: "楕円曲線を用いた鍵交換プロトコル。通信路上で共通秘密を安全に導出する。TLS 1.3の鍵交換で標準的に使用される。量子コンピュータで破られる。",
    tags: ["ECC", "ECDH", "key-exchange"],
    relatedLessonId: "cc-lesson-3",
  },
  {
    id: "cc-fc10",
    topicId: "current-cryptography",
    front: "計算量的安全性と情報理論的安全性の違いは？",
    back: "計算量的安全性: 現実的な計算資源では破れないという仮定に基づく（RSA、AES等）。計算能力の向上で崩れるリスクあり。\n情報理論的安全性: 無限の計算資源でも原理的に破れない（ワンタイムパッド等）。実用上の制約が大きい。",
    tags: ["security", "computational", "information-theoretic"],
    relatedLessonId: "cc-lesson-4",
  },
  {
    id: "cc-fc11",
    topicId: "current-cryptography",
    front: "HNDL（Harvest Now, Decrypt Later）攻撃とは？",
    back: "現在の暗号通信を傍受・保存しておき、将来量子コンピュータが実用化された時点で復号する攻撃戦略。長期間の機密性が求められる金融データや政府通信に対して深刻な脅威。今からPQC対策が必要な最大の理由の一つ。",
    tags: ["HNDL", "quantum-threat", "attack"],
    relatedLessonId: "cc-lesson-4",
  },
  {
    id: "cc-fc12",
    topicId: "current-cryptography",
    front: "Crypto Agility（暗号の俊敏性）とは？",
    back: "暗号アルゴリズムやプロトコルを迅速に切り替えられるシステム設計原則。PQC移行の基盤。暗号をハードコードせず、設定で切り替え可能にする。暗号インベントリの管理も含む。",
    tags: ["crypto-agility", "migration", "design"],
    relatedLessonId: "cc-lesson-4",
  },
  {
    id: "cc-fc13",
    topicId: "current-cryptography",
    front: "NISTセキュリティレベルの5段階とは？",
    back: "Level 1: AES-128全数探索相当\nLevel 2: SHA-256衝突探索相当\nLevel 3: AES-192全数探索相当\nLevel 4: SHA-384衝突探索相当\nLevel 5: AES-256全数探索相当\nPQCアルゴリズムもこの基準で評価される。",
    tags: ["NIST", "security-level"],
    relatedLessonId: "cc-lesson-4",
  },
  {
    id: "cc-fc14",
    topicId: "current-cryptography",
    front: "TLS 1.3の暗号スイート構成は？",
    back: "鍵交換: ECDH（またはDH）\nバルク暗号化: AES-128-GCM / AES-256-GCM / ChaCha20-Poly1305\n署名: ECDSA / RSA-PSS / Ed25519\nハッシュ: SHA-256 / SHA-384\n\nすべての組み合わせで前方秘匿性（PFS）を必須化。",
    tags: ["TLS", "cipher-suite", "protocol"],
    relatedLessonId: "cc-lesson-1",
  },
  {
    id: "cc-fc15",
    topicId: "current-cryptography",
    front: "量子コンピュータに対する各暗号方式の耐性は？",
    back: "○ 安全: AES-256（128ビット相当に低下するが十分）\n× 破られる: RSA（Shor）、ECC（Shor）、DH（Shor）\n△ 弱体化: SHA-256（Groverで衝突探索が高速化）\n\n→ 公開鍵暗号は全面的な置き換えが必要。対称鍵は鍵長を倍にすれば対応可能。",
    tags: ["quantum-resistance", "overview"],
    relatedLessonId: "cc-lesson-4",
  },
] as const satisfies readonly FlashcardDefinition[];
