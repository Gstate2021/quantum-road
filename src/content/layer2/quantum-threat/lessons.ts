import type { Lesson } from "@/types/content";

export const quantumThreatLessons: readonly Lesson[] = [
  {
    id: "qt-lesson-1",
    topicId: "quantum-threat",
    order: 1,
    title: "量子ビットの基本概念",
    estimatedMinutes: 35,
    sections: [
      {
        type: "text",
        content:
          "量子コンピュータの基本単位は量子ビット（qubit）です。古典ビットが0か1の一方の状態しか取れないのに対し、量子ビットは0と1の「重ね合わせ状態」を取ることができます。\n\n量子ビットの状態は |ψ⟩ = α|0⟩ + β|1⟩ で表されます。α、βは複素数の確率振幅で、|α|² + |β|² = 1 を満たします。測定するとα²の確率で0、β²の確率で1が得られます。",
      },
      {
        type: "callout",
        content:
          "量子ビットは「0と1の両方を同時に持っている」のではなく、「0と1の重ね合わせ状態にある」と正確に表現します。測定した瞬間に一方に確定します。この違いを正しく伝えることがコンサルティングでは重要です。",
        calloutType: "important",
      },
      {
        type: "text",
        content:
          "量子コンピューティングの3つの基本原理:\n\n1. **重ね合わせ（Superposition）**: 量子ビットは0と1の重ね合わせ状態を取れる。n量子ビットで2ⁿ個の状態を同時に表現可能。\n\n2. **量子もつれ（Entanglement）**: 2つ以上の量子ビットが相関した状態。一方を測定すると他方の状態が瞬時に確定する。\n\n3. **量子干渉（Interference）**: 確率振幅の加算・打ち消しにより、正しい答えの確率を増幅し、間違った答えの確率を減少させる。\n\nこの3つを組み合わせることで、特定の問題に対して古典コンピュータを圧倒的に上回る計算能力を実現します。",
      },
      {
        type: "diagram",
        content:
          "量子コンピュータの計算能力:\n\n量子ビット数 | 同時表現可能な状態数\n1           | 2\n10          | 1,024\n50          | ~10¹⁵（1,000兆）\n100         | ~10³⁰\n300         | ~10⁹⁰（宇宙の原子数を超える）\n\n※ これは「同時に計算できる」という意味ではなく、\n   重ね合わせで表現できる状態空間の大きさ。\n   実際の計算能力はアルゴリズムの設計に依存する。",
      },
      {
        type: "text",
        content:
          "重要な注意点として、量子コンピュータは「全ての計算が速い」わけではありません。量子優位性が発揮されるのは特定の問題構造に対してのみです。暗号を破る問題はその代表例であり、Shorのアルゴリズム（素因数分解）とGroverのアルゴリズム（探索）が暗号にとっての脅威となります。",
      },
    ],
    keyConcepts: [
      {
        term: "量子ビット",
        termEn: "Qubit",
        definition:
          "量子コンピュータの基本単位。0と1の重ね合わせ状態を取れる。|ψ⟩ = α|0⟩ + β|1⟩ で表現される。",
      },
      {
        term: "重ね合わせ",
        termEn: "Superposition",
        definition:
          "量子ビットが0と1の線形結合状態を取る性質。n量子ビットで2ⁿ個の状態を同時に表現可能。",
      },
      {
        term: "量子もつれ",
        termEn: "Entanglement",
        definition:
          "複数の量子ビットが非古典的に相関した状態。一方の測定結果が他方の状態を即座に確定させる。量子アルゴリズムの並列性の鍵。",
      },
      {
        term: "量子干渉",
        termEn: "Quantum Interference",
        definition:
          "確率振幅の建設的・破壊的干渉。正しい答えの確率を増幅し、誤った答えの確率を減少させるメカニズム。",
      },
    ],
  },
  {
    id: "qt-lesson-2",
    topicId: "quantum-threat",
    order: 2,
    title: "Shorのアルゴリズム概要",
    estimatedMinutes: 40,
    sections: [
      {
        type: "text",
        content:
          "Shorのアルゴリズムは、1994年にPeter Shorが発表した量子アルゴリズムで、整数の素因数分解を多項式時間で解きます。古典コンピュータでは準指数時間（一般数体篩法でO(exp(n^(1/3)))）かかる問題が、量子コンピュータではO(n³)で解けます。\n\nこのアルゴリズムが現行暗号に与えるインパクトは破壊的です。RSA、Diffie-Hellman、楕円曲線暗号（ECC）はすべてShorのアルゴリズムで破られます。",
      },
      {
        type: "diagram",
        content:
          "Shorのアルゴリズムの概要（高レベル）:\n\n1. 素因数分解を「位数発見問題」に帰着\n   N = p × q を分解したい\n   ランダムな a を選び、f(x) = a^x mod N の周期 r を求める\n\n2. 量子フーリエ変換（QFT）で周期 r を効率的に求める\n   → 古典部分: a の選択、gcd 計算\n   → 量子部分: 周期発見（QFT）\n\n3. r が偶数なら gcd(a^(r/2) ± 1, N) で因数を得る\n\n計算量: O((log N)³) — Nの桁数の3乗に比例\n古典最良: O(exp((log N)^(1/3))) — 準指数時間",
      },
      {
        type: "callout",
        content:
          "Shorのアルゴリズムを理解する上で重要なのは、「量子コンピュータが素因数分解を高速に解く」のではなく、「周期発見という数学的構造を量子フーリエ変換で効率的に解く」点です。コンサルティングでは深い数学は不要ですが、原理を正しく説明できることが信頼につながります。",
        calloutType: "tip",
      },
      {
        type: "text",
        content:
          "RSA-2048を破るには、現在の推定で約4,000〜20,000量子ビット（論理量子ビット）が必要とされています。誤り訂正を含む物理量子ビットでは数百万ビット規模になります。\n\n2025年時点で最大の量子コンピュータは約1,000物理量子ビット程度ですが、技術は急速に進歩しています。NISTは2030年代にはリスクが顕在化する可能性を示唆しており、「今から準備する」必要性が高まっています。",
      },
      {
        type: "text",
        content:
          "Shorのアルゴリズムが破る暗号方式:\n\n- **RSA**: 素因数分解問題に直接適用\n- **Diffie-Hellman鍵交換**: 離散対数問題に適用\n- **ECDH / ECDSA**: 楕円曲線離散対数問題に適用\n- **DSA**: 離散対数問題に適用\n\nつまり、現在のインターネットで使われている公開鍵暗号のほぼ全てが影響を受けます。",
      },
    ],
    keyConcepts: [
      {
        term: "Shorのアルゴリズム",
        termEn: "Shor's Algorithm",
        definition:
          "1994年発表の量子アルゴリズム。整数の素因数分解と離散対数をO(n³)の多項式時間で解く。RSA、ECC等の現行公開鍵暗号を破る。",
      },
      {
        term: "量子フーリエ変換",
        termEn: "Quantum Fourier Transform (QFT)",
        definition:
          "古典の離散フーリエ変換の量子版。O(n²)で計算可能。Shorのアルゴリズムの核心部分で周期発見に使用。",
      },
      {
        term: "論理量子ビット",
        termEn: "Logical Qubit",
        definition:
          "誤り訂正符号で保護された「完全な」量子ビット。1論理量子ビットに数千の物理量子ビットが必要。Shorアルゴリズムの議論では論理量子ビット数で語られる。",
      },
    ],
  },
  {
    id: "qt-lesson-3",
    topicId: "quantum-threat",
    order: 3,
    title: "Groverのアルゴリズム概要",
    estimatedMinutes: 30,
    sections: [
      {
        type: "text",
        content:
          "Groverのアルゴリズムは、1996年にLov Groverが発表した量子探索アルゴリズムです。N個の要素からターゲットを見つける問題を、古典的なO(N)からO(√N)に高速化します。\n\nShorのアルゴリズムほど劇的な高速化ではありませんが、対称鍵暗号とハッシュ関数の安全性に影響を与えます。",
      },
      {
        type: "diagram",
        content:
          "Groverのアルゴリズムの影響:\n\n暗号方式        | 古典安全性   | Grover適用後 | 実質的な影響\n──────────────────────────────────────────────────────\nAES-128        | 128ビット    | 64ビット     | 安全でない\nAES-192        | 192ビット    | 96ビット     | やや安全\nAES-256        | 256ビット    | 128ビット    | 安全\nSHA-256 原像   | 256ビット    | 128ビット    | 安全\nSHA-256 衝突   | 128ビット    | 85ビット※    | やや弱体化\n\n※ 衝突探索へのGroverの適用は単純な√ではない",
      },
      {
        type: "text",
        content:
          "Groverのアルゴリズムのメカニズムは「振幅増幅」です:\n\n1. 全ての状態を均等な重ね合わせに初期化\n2. オラクル（目的の状態を反転するブラックボックス）を適用\n3. 「拡散演算子」で振幅を増幅\n4. ステップ2-3を√N回繰り返す\n5. 測定すると高確率で正解が得られる\n\nポイントは、繰り返し回数が√Nに比例するという最適性です。これは証明されており、量子コンピュータでもこれ以上の高速化は不可能です。",
      },
      {
        type: "callout",
        content:
          "Groverの高速化は「二乗根の高速化」であり、鍵長を2倍にすれば対策できます。AES-128→AES-256への移行で量子耐性を確保できるため、対称鍵暗号の移行は比較的容易です。Shorのアルゴリズムによる公開鍵暗号の破壊とは質的に異なります。",
        calloutType: "tip",
      },
      {
        type: "text",
        content:
          "実務上の判断ポイント:\n\n- 対称鍵暗号: AES-256を使えば量子耐性を確保（Groverの影響は限定的）\n- ハッシュ関数: SHA-256は原像攻撃に対して128ビット相当で依然として安全\n- パスワードハッシュ: bcrypt/scrypt等のメモリハード関数はGroverの影響を受けにくい\n- 公開鍵暗号: Shorで完全に破られる → PQCへの移行が必須\n\nクライアントへの説明では「対称鍵は鍵長を上げれば済む、公開鍵は根本的な置き換えが必要」と伝えるのが効果的です。",
      },
    ],
    keyConcepts: [
      {
        term: "Groverのアルゴリズム",
        termEn: "Grover's Algorithm",
        definition:
          "1996年発表の量子探索アルゴリズム。N要素の非構造的探索をO(√N)で実行。対称鍵暗号の安全性を半減させるが、鍵長を2倍にすれば対策可能。",
      },
      {
        term: "振幅増幅",
        termEn: "Amplitude Amplification",
        definition:
          "量子干渉を利用して目的の状態の確率振幅を増幅する手法。Groverのアルゴリズムの核心メカニズム。",
      },
      {
        term: "オラクル",
        termEn: "Oracle",
        definition:
          "目的の状態を判定するブラックボックス関数。Groverのアルゴリズムでは、正解の状態の位相を反転する量子ゲートとして実装される。",
      },
    ],
  },
  {
    id: "qt-lesson-4",
    topicId: "quantum-threat",
    order: 4,
    title: "量子で何が壊れるか",
    estimatedMinutes: 30,
    sections: [
      {
        type: "text",
        content:
          "量子コンピュータの脅威を体系的に整理しましょう。影響の大きさは暗号方式のカテゴリによって根本的に異なります。\n\n**完全に破壊される（Shorのアルゴリズム）:**\n- RSA（全鍵長）\n- Diffie-Hellman / ECDH（鍵交換）\n- ECDSA / DSA / EdDSA（デジタル署名）\n- ElGamal暗号\n\n**弱体化するが対策可能（Groverのアルゴリズム）:**\n- AES-128 → 安全でない（64ビット相当）\n- AES-256 → 安全（128ビット相当）\n- SHA-256 → 実用上安全\n\n**影響を受けない:**\n- ワンタイムパッド\n- 情報理論的に安全なプロトコル",
      },
      {
        type: "diagram",
        content:
          "影響を受けるプロトコルとシステム:\n\nTLS/HTTPS     → 鍵交換(ECDH)と署名(ECDSA)が破られる\nSSH           → ホスト認証とユーザー認証が破られる\nVPN (IPsec)   → IKEの鍵交換が破られる\nPKI / 証明書   → RSA/ECC署名の証明書が無効化\n電子署名       → 法的効力のある署名が偽造可能に\nブロックチェーン → ECDSA署名が偽造可能に\nコードサイニング → ソフトウェア署名が偽造可能に\nS/MIME / PGP   → メール暗号化・署名が破られる",
      },
      {
        type: "callout",
        content:
          "NISTは2035年までにRSA-2048とECC P-256を非推奨化する方針を示しています。しかしHNDL攻撃を考慮すると、機密性の高いデータを扱うシステムは今すぐ移行計画を策定すべきです。移行には数年かかるため、「まだ量子コンピュータは実用化されていない」は理由になりません。",
        calloutType: "warning",
      },
      {
        type: "text",
        content:
          "量子脅威のタイムライン（業界コンセンサス）:\n\n- **今（2025-2026）**: PQC標準が確定、移行計画の策定開始\n- **2027-2030**: 早期導入者がPQCへの移行を完了\n- **2030-2035**: NIST非推奨化、大規模移行期\n- **2030年代後半〜**: 暗号学的に意味のある量子コンピュータ（CRQC）が出現する可能性\n\n移行にかかる期間を考えると、大規模システムでは5-10年の猶予は決して長くありません。Y2Kの教訓を活かし、計画的に進める必要があります。",
      },
      {
        type: "example",
        content:
          "PQC移行コンサルティングでの説明例:\n\n「お客様のTLS通信では、鍵交換にECDH P-256、署名にECDSA P-256を使用しています。これらは量子コンピュータのShorアルゴリズムで破られます。データの暗号化に使っているAES-256は量子耐性がありますが、鍵交換が破られるとAESの鍵自体が漏洩します。つまり、通信全体の安全性が崩れます。\n\n対策として、鍵交換をML-KEMに、署名をML-DSAに置き換える必要があります。まずは暗号インベントリの作成から始めることをお勧めします。」",
      },
    ],
    keyConcepts: [
      {
        term: "CRQC",
        termEn: "Cryptographically Relevant Quantum Computer",
        definition:
          "暗号学的に意味のある量子コンピュータ。RSA-2048やECC P-256を破れる規模の量子コンピュータ。2030年代後半の出現が予想される。",
      },
      {
        term: "暗号インベントリ",
        termEn: "Cryptographic Inventory",
        definition:
          "組織内で使用されている全暗号方式、プロトコル、証明書、鍵の棚卸し。PQC移行の第一歩であり、影響範囲の特定に不可欠。",
      },
      {
        term: "PQC移行タイムライン",
        termEn: "PQC Migration Timeline",
        definition:
          "NISTは2035年までにRSA/ECCの非推奨化を予定。HNDL脅威を考慮すると機密データ処理システムは即座に移行計画を策定すべき。移行には5-10年かかる。",
      },
    ],
  },
] as const satisfies readonly Lesson[];
